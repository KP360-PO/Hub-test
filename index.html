<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>KP360 Â· PO Hub</title>
  <link rel="icon" href="https://www.karparts360.com/images/simplecms/favicon.ico" type="image/x-icon">
  <meta name="color-scheme" content="light dark" />

  <!-- Perf hints -->
  <link rel="preconnect" href="https://raw.githubusercontent.com" crossorigin>
  <link rel="preconnect" href="https://script.google.com" crossorigin>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>

  <!-- Assets (cache-busted) -->
  <link rel="stylesheet" href="styles.css?v=10" />
  <script defer src="app.js?v=10"></script>
</head>
<body>
  <!-- Passcode Gate -->
  <div id="lockScreen" style="
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:var(--bg,#f9fafb);display:flex;flex-direction:column;
    align-items:center;justify-content:center;z-index:9999;
    font-family:Inter,Arial,sans-serif;text-align:center;
    transition:opacity .3s ease;">
    <div style="
      background:var(--card,#fff);padding:2rem 2.5rem;border-radius:1rem;
      box-shadow:0 4px 12px rgba(0,0,0,.1);max-width:320px;width:90%;">
      <h2 style="margin:0 0 1rem;color:var(--ink,#111)">ðŸ”’ PO Hub Access</h2>
      <p style="margin:.5rem 0 1.5rem;color:var(--ink-2,#555);font-size:.95rem">
        Please enter the passcode to continue.
      </p>
      <input type="password" id="passInput" placeholder="Enter passcode"
        style="padding:.6rem .8rem;border:1px solid var(--border,#ccc);
        border-radius:.5rem;width:100%;margin-bottom:1rem;
        background:var(--bg,#fff);color:var(--ink,#111);">
      <button onclick="checkPasscode()" style="
        padding:.6rem 1rem;width:100%;border:none;border-radius:.5rem;
        background:#2563eb;color:white;font-weight:600;cursor:pointer;">
        Unlock
      </button>
      <p id="errorMsg" style="color:#dc2626;display:none;margin-top:.75rem;font-size:.9rem;">
        Wrong passcode. Try again.
      </p>
    </div>
  </div>

  <!-- Header -->
  <header class="site-header" id="header">
    <div class="container header-inner">
      <div class="brand" data-view="home" title="Go home">
        <img src="https://raw.githubusercontent.com/purchase-order-team/Processors/main/path/to/photos/Default%20KarParts360%20LOGO%20Version%203.png" alt="KarParts360" />
        <strong>PO TEAM</strong>
      </div>
      <nav class="primary-nav" id="primary-nav">
        <ul><li><a href="#" data-view="home">Home</a></li></ul>
        <button class="icon-btn" id="themeToggle" aria-label="Toggle dark/light"></button>
      </nav>
    </div>
  </header>

  <!-- Hero/Home -->
  <section class="hero page active" data-page="home">
    <div class="container">
      <h1>PO Hub â€” No Missing Pieces</h1>
      <p>Unless someone forgot to submit the order.</p>

      <!-- Global Search -->
      <form class="search" onsubmit="event.preventDefault()" role="search">
        <input id="globalSearch" type="search"
               placeholder="Search tools, pages, keywordsâ€¦ (e.g., â€˜SOP returnsâ€™, â€˜marketplace KPIâ€™, â€˜supplier portalâ€™)"
               aria-label="Search" autocomplete="off" />
        <button type="submit" id="searchBtn">Search</button>
        <div class="results" id="searchResults" role="listbox" aria-label="Search results"></div>
      </form>
    </div>
  </section>

  <main class="container page active" data-page="home">
    <section class="categories" aria-label="Quick links">
      <a class="category" href="#" data-view="po-projects">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 7.5a2 2 0 0 1 2-2h4l2 2h8a2 2 0 0 1 2 2V18a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7.5Z"/><path d="M3 10h18"/>
          </svg>
        </span>
        <span class="title">PO Projects</span>
      </a>

      <a class="category" href="#" data-view="supplier-contacts">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="8" cy="8" r="3"/><circle cx="16" cy="8" r="3"/><path d="M3 20a5 5 0 0 1 10 0"/><path d="M11 20a5 5 0 0 1 10 0"/>
          </svg>
        </span>
        <span class="title">Supplier Contacts</span>
      </a>

      <a class="category" href="#" data-view="email-templates">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="5" width="18" height="14" rx="2"/><path d="M3 7l9 6 9-6"/>
          </svg>
        </span>
        <span class="title">Email Templates</span>
      </a>

      <a class="category" href="#" data-view="schedule">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="18" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/>
          </svg>
        </span>
        <span class="title">Schedule</span>
      </a>

      <a class="category" href="#" data-view="task-monitoring">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 3h18v4H3z"/><path d="M3 11h18v4H3z"/><path d="M3 19h18v2H3z"/>
          </svg>
        </span>
        <span class="title">Task Monitoring</span>
      </a>

      <a class="category" href="#" data-view="tracker">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <rect x="4" y="4" width="16" height="16" rx="3"/><path d="M7.5 12.5l3 3 6-7"/>
          </svg>
        </span>
        <span class="title">Tracker</span>
      </a>

      <a class="category" href="#" data-view="marketplace-performance">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 19h18"/><path d="M7 19V10"/><path d="M12 19V5"/><path d="M17 19V13"/>
          </svg>
        </span>
        <span class="title">Marketplace Performance</span>
      </a>

      <a class="category" href="#" data-view="top-performers">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M8 21h8M9 17h6m-8-9V4h10v4a5 5 0 0 1-10 0Z"/>
          </svg>
        </span>
        <span class="title">Top Performers</span>
      </a>

      <!-- NEW categories -->
      <a class="category" href="#" data-view="po-spreadsheets" title="PO Spreadsheets">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="4" width="18" height="16" rx="2"/><path d="M7 8h10M7 12h10M7 16h6"/>
          </svg>
        </span>
        <span class="title">PO Spreadsheets</span>
      </a>

      <a class="category" href="#" data-view="po-tools" title="PO Tools">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14 7l-5 5 3 3 5-5"/><path d="M18.5 2.5a2.1 2.1 0 0 1 3 3L20 7l-3-3 1.5-1.5z"/><path d="M2 22l6-2 8-8-4-4-8 8-2 6z"/>
          </svg>
        </span>
        <span class="title">PO Tools</span>
      </a>

      <a class="category" href="#" data-view="marketplaces" title="Marketplaces">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 7h18l-2 12H5L3 7z"/><path d="M16 7a4 4 0 0 1-8 0"/>
          </svg>
        </span>
        <span class="title">Marketplaces</span>
      </a>

      <a class="category" href="#" data-view="mailboxes" title="Mailboxes">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <rect x="3" y="5" width="18" height="14" rx="2"/><path d="M3 7l9 6 9-6"/>
          </svg>
        </span>
        <span class="title">Mailboxes</span>
      </a>

      <a class="category" href="#" data-view="supplier-websites" title="Supplier Websites">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"/><path d="M2 12h20M12 2a15 15 0 0 1 0 20M12 2a15 15 0 0 0 0 20"/>
          </svg>
        </span>
        <span class="title">Supplier Websites</span>
      </a>

      <!-- NEW: SOPs -->
      <a class="category" href="#" data-view="sops" title="Standard Operating Procedures">
        <span class="icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <path d="M4 4h10l4 4v12a2 2 0 0 1-2 2H4z"/><path d="M14 4v4h4"/><path d="M7 12h8"/><path d="M7 16h8"/>
          </svg>
        </span>
        <span class="title">SOPs</span>
      </a>
    </section>
  </main>

  <!-- Pages -->
  <section class="container page" data-page="po-projects">
    <div class="iframe-wrap">
      <iframe title="PO Projects" src="https://kp360-po.github.io/KPP/PO_Portal.html" loading="lazy"></iframe>
    </div>
  </section>

  <section class="container page" data-page="supplier-contacts">
    <div class="content">
      <div class="contacts-controls">
        <strong>Supplier Contacts</strong>
        <input id="contactsSearch" type="search" placeholder="Search name, supplier, email, phone, notesâ€¦" />
        <label>Supplier:
          <select id="contactsSupplierFilter"><option value="">All</option></select>
        </label>
        <span class="contacts-status" id="contactsStatus">Loadingâ€¦</span>
      </div>
      <div id="contactsTableWrap"></div>
      <div id="contactsError" class="error" style="display:none"></div>
    </div>
  </section>

  <section class="container page" data-page="email-templates">
    <div class="iframe-wrap">
      <iframe title="Email Templates" src="https://kp360-po.github.io/KPP/EmailTemplates.html" loading="lazy"></iframe>
    </div>
  </section>

  <section class="container page" data-page="schedule">
    <div class="iframe-wrap">
      <iframe title="Schedule" src="https://netorgft5128391.sharepoint.com/:x:/s/POTEAM/EYDj32TObklAm3lXkm-i8nABDVhrVsumG3LWzLhfc9ODxw?e=FKdzui" loading="lazy"></iframe>
    </div>
  </section>

  <section class="container page" data-page="task-monitoring">
    <div class="iframe-wrap">
      <iframe title="Task Monitoring" src="https://kp360-po.github.io/task-tracker/" loading="lazy"></iframe>
    </div>
  </section>

  <section class="container page" data-page="marketplace-performance">
    <div class="content"><p>KPIs, revenue trends, conversion rates, and marketplace health indicators.</p></div>
  </section>

  <section class="container page" data-page="top-performers">
    <div class="content">
      <h2 style="margin:0 0 .75rem">Top Performers of the Month</h2>
      <div class="tp-grid" id="tp-page-grid"></div>
    </div>
  </section>

  <!-- NEW PAGES (link grids) -->
  <section class="container page" data-page="po-spreadsheets">
    <div class="content">
      <h2 style="margin-top:0">PO Spreadsheets</h2>
      <div id="grid-po-spreadsheets"></div>
    </div>
  </section>

  <section class="container page" data-page="po-tools">
    <div class="content">
      <h2 style="margin-top:0">PO Tools</h2>
      <div id="grid-po-tools"></div>
    </div>
  </section>

  <section class="container page" data-page="marketplaces">
    <div class="content">
      <h2 style="margin-top:0">Marketplaces</h2>
      <div id="grid-marketplaces"></div>
    </div>
  </section>

  <section class="container page" data-page="tracker">
    <div class="content">
      <h2 style="margin-top:0">Tracker</h2>
      <div id="grid-tracker"></div>
    </div>
  </section>

  <section class="container page" data-page="mailboxes">
    <div class="content">
      <h2 style="margin-top:0">Mailboxes</h2>
      <div id="grid-mailboxes"></div>
    </div>
  </section>

  <section class="container page" data-page="supplier-websites">
    <div class="content">
      <h2 style="margin-top:0">Supplier Websites</h2>
      <div id="grid-supplier-websites"></div>
    </div>
  </section>

  <section class="container page" data-page="sops">
    <div class="content">
      <h2 style="margin-top:0">SOPs</h2>
      <div id="grid-sops"></div>
    </div>
  </section>

  <!-- Footer -->
  <footer id="footer">Â© KarParts360 PO Team 2025</footer>
</body>
</html>
