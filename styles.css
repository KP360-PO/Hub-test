/* =======================
   KP360 Operations Portal
   Global Styles (Light & Dark)
   ======================= */

/* ---------- Theme tokens ---------- */
:root{
  --brand:#1f2937; --brand-600:#111827;

  --ink:#0f172a;           /* primary text */
  --ink-2:#4b5563;         /* secondary text */
  --bg:#f6f7fb;
  --card:#ffffff;
  --border:#e5e7eb;
  --muted:#6b7280;

  --ring-steel-from:#e9eef7;
  --ring-steel-to:#cfd8e6;

  --header-h:64px;         /* header height for sticky math */
  --footer-h:36px;

  /* Search results palette */
  --res-bg: var(--card);
  --res-title:#111827;
  --res-sub:#475569;
  --res-url:#374151;
  --res-row:#ffffff;
  --res-row-hover:#f3f4f6;
  --res-open-bg:#f8fafc;
}

/* Dark mode tokens */
body.dark{
  --brand:#60a5fa; --brand-600:#3b82f6;

  --ink:#e5e7eb;
  --ink-2:#9ca3af;
  --bg:#0f172a;
  --card:#1e293b;
  --border:#334155;
  --muted:#94a3b8;

  --ring-steel-from:#334155;
  --ring-steel-to:#475569;

  /* Search results palette (dark) */
  --res-bg:#141c2b;
  --res-title:#e5e7eb;
  --res-sub:#b0bccb;
  --res-url:#c3ccd8;
  --res-row:#1e293b;
  --res-row-hover:rgba(255,255,255,.09);
  --res-open-bg:#0f172a;
}

/* ---------- Base ---------- */
*{ box-sizing:border-box }
html,body{ height:100% }
body{
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
  margin:0;
  line-height:1.6;
  background:var(--bg);
  color:var(--ink);
  padding-bottom:var(--footer-h);
  transition: background .25s ease, color .25s ease;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}
a{ color:inherit; text-decoration:none }
.container{ width:min(1400px,96%); margin-inline:auto }

/* ---------- Header ---------- */
.site-header{
  position:sticky; top:0; z-index:60;
  background:rgba(255,255,255,.85);
  backdrop-filter:saturate(1.15) blur(8px);
  border-bottom:1px solid var(--border);
  height:var(--header-h);
  transition: background .25s;
}
body.dark .site-header{ background:rgba(15,23,42,.9) }
.header-inner{
  display:flex; align-items:center; gap:.6rem;
  min-height:var(--header-h); padding:.2rem .4rem;
}
.brand{ display:flex; align-items:center; gap:.5rem; cursor:pointer }
.brand img{ height:22px; display:block }
.brand strong{ font-size:.9rem }
.primary-nav{ margin-left:auto; display:flex; align-items:center; gap:.6rem }
.primary-nav ul{ list-style:none; display:flex; gap:.6rem; margin:0; padding:0 }
.primary-nav a{
  color:var(--ink-2); font-weight:600; font-size:.85rem;
  padding:.25rem .45rem; border-radius:.4rem;
  transition: background .2s, color .2s;
}
.primary-nav a:hover{ color:var(--ink); background:rgba(0,0,0,.05) }
body.dark .primary-nav a:hover{ background:rgba(255,255,255,.06) }
.icon-btn{
  border:1px solid var(--border); background:var(--card); color:var(--ink);
  width:32px; height:32px; display:grid; place-items:center; border-radius:.45rem;
  cursor:pointer; padding:0; line-height:0;
  transition: background .2s, border-color .2s, filter .2s;
}
.icon-btn svg{ width:18px; height:18px; stroke:currentColor; display:block }
.icon-btn:hover{ filter:brightness(.98) }

/* ---------- Hero + Search ---------- */
.hero{
  background:linear-gradient(180deg,var(--brand),var(--brand-600));
  color:#fff; padding:1.2rem 0; transition: background .25s;
}
body.dark .hero{ background:linear-gradient(180deg,#1e40af 0%, #1e293b 100%) }
.hero h1{ margin:0 0 .25rem; font-size:1.5rem }
.hero p{ margin:.1rem 0 .8rem; opacity:.95 }

.search{
  position:relative; display:flex; max-width:620px;
  background:#fff; border-radius:.6rem; overflow:visible;
  box-shadow:0 10px 24px rgba(0,0,0,.15);
}
.search input{
  flex:1; border:0; padding:.6rem .75rem; font-size:.95rem; color:#111; background:transparent;
}
.search button{
  background:var(--brand); color:#fff; border:0; padding:.6rem .9rem; font-weight:700; border-radius:0 .6rem .6rem 0;
}
body.dark .search{ background:#0b1220; box-shadow:0 0 0 1px var(--border) }
body.dark .search input{ color:var(--ink) }

/* ---------- Categories ---------- */
categories, .categories{
  display:grid; grid-template-columns:repeat(auto-fill, minmax(clamp(160px,22vw,260px),1fr));
  gap:clamp(.6rem,1.5vw,1.2rem); margin:1.4rem 0 1.6rem
}
.category{
  background:var(--card); border:1px solid var(--border); border-radius:1rem;
  padding:clamp(.75rem,1.4vw,1.1rem); text-align:center;
  box-shadow:0 1px 10px rgba(0,0,0,.05);
  transition: transform .15s ease, box-shadow .15s ease, background .25s, border-color .25s;
}
.category:hover{ transform:translateY(-2px); box-shadow:0 8px 20px rgba(0,0,0,.08) }
.icon{
  position:relative; width:clamp(66px,10vw,86px); height:clamp(66px,10vw,86px); margin:auto; border-radius:50%;
  display:grid; place-items:center;
  background:radial-gradient(closest-side,#fff 64%,transparent 66%), conic-gradient(var(--ring-steel-from),var(--ring-steel-to));
  box-shadow:0 8px 18px rgba(0,0,0,.06), inset 0 0 0 1px rgba(255,255,255,.8)
}
.icon svg{ width:clamp(30px,5vw,40px); height:clamp(30px,5vw,40px) }
body.dark .icon svg{ color:var(--brand) }
.category .title{ display:block; margin-top:.65rem; font-weight:700; font-size:clamp(.9rem,1.2vw,1rem) }

/* ---------- Content / Iframes ---------- */
.content{
  background:var(--card); border:1px solid var(--border); border-radius:12px; padding:1rem; margin-bottom:1rem;
  box-shadow:0 1px 6px rgba(0,0,0,.04); transition: background .25s, border-color .25s;
}
.iframe-wrap{ border:1px solid var(--border); border-radius:10px; overflow:hidden; background:var(--card) }
.iframe-wrap iframe{ width:100%; height:calc(100vh - var(--header-h) - var(--footer-h)); border:0; display:block }

/* ---------- Router visibility ---------- */
.page{ display:none }
.page.active{ display:block }

/* ---------- Footer ---------- */
footer{
  position:fixed; bottom:0; left:0; right:0; text-align:center;
  padding:.35rem 0; color:var(--muted);
  border-top:1px solid var(--border); font-size:.72rem; background:#f9fafb; z-index:70;
  transition: background .25s, color .25s, border-color .25s;
}
footer.slim{ padding:.25rem 0; font-size:.68rem; opacity:.9 }
body.dark footer{ background:#0b1220 }

/* ---------- Supplier Contacts ---------- */
.contacts-controls{
  display:flex; gap:.6rem; align-items:center; flex-wrap:wrap; margin-bottom:.6rem
}
.contacts-controls input,.contacts-controls select{
  padding:.5rem .6rem; border:1px solid var(--border); border-radius:.5rem; background:var(--card); color:var(--ink)
}
.contacts-controls input{ min-width:220px }
.contacts-status{ font-size:.85rem; color:var(--ink-2) }

.contacts-table{
  width:100%; border-collapse:collapse; background:var(--card);
  border:1px solid var(--border); border-radius:10px; overflow:hidden
}
.contacts-table th,.contacts-table td{
  padding:.6rem .7rem; border-bottom:1px solid var(--border);
  text-align:left; font-size:.92rem; vertical-align:top
}
.contacts-table th{
  background:linear-gradient(180deg, #f8fafc, #f1f5f9); font-weight:700
}
body.dark .contacts-table th{ background:linear-gradient(180deg, #0b1220, #111827) }

.error{
  background:#fff3f3; border:1px solid #fca5a5; color:#991b1b;
  padding:.6rem .8rem; border-radius:.5rem
}

/* ---------- Top performers ---------- */
#tp-page-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:12px }
.tp-card{
  background:var(--card); border:1px solid var(--border); border-radius:12px;
  padding:10px; text-align:center
}
.tp-card img{
  width:110px; height:110px; border-radius:50%; object-fit:cover;
  box-shadow:0 4px 12px rgba(0,0,0,.15);
  transition: filter .25s ease, opacity .2s;
}
.tp-card img.img-loading{ filter:blur(8px); opacity:.7 }
.tp-card .name{ font-weight:700; margin-top:.4rem }

/* Modal */
.tp-overlay{ position:fixed; inset:0; background:rgba(0,0,0,.5); display:flex; align-items:center; justify-content:center; z-index:1000 }
.tp-modal{
  width:min(900px,92%); background:var(--card); color:var(--ink);
  border:1px solid var(--border); border-radius:16px;
  box-shadow:0 20px 50px rgba(0,0,0,.3); overflow:hidden
}
.tp-head{
  display:flex; justify-content:space-between; align-items:center;
  padding:12px 14px; background:linear-gradient(180deg,var(--brand),var(--brand-600)); color:#fff
}
.tp-close{
  border:1px solid rgba(255,255,255,.5); background:transparent; color:#fff;
  padding:.35rem .6rem; border-radius:8px; cursor:pointer
}
.tp-body{ padding:14px }
.tp-grid{ display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:12px }
.tp-skeleton{ display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:12px }
.tp-skeleton .cell{
  height:160px; border-radius:12px;
  background:linear-gradient(90deg,#eee,#f5f5f5,#eee);
  background-size:200% 100%; animation:shine 1.1s linear infinite
}
@keyframes shine{ 0%{background-position:200% 0} 100%{background-position:-200% 0} }

/* ---------- Link grids (pretty cards) ---------- */
.links-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(clamp(180px,22vw,260px),1fr));
  gap:clamp(.6rem,1.4vw,1rem);
}

.link-card{
  display:grid;
  grid-template-columns:auto 1fr auto;
  grid-template-areas:
    "ico title open"
    "ico note  open";
  align-items:center;
  gap:.65rem .75rem;

  background:var(--card);
  border:1px solid var(--border);
  border-radius:14px;
  padding:.85rem .9rem;
  box-shadow:0 1px 10px rgba(0,0,0,.05);
  transition: transform .15s ease, box-shadow .15s ease, border-color .2s, background .2s;
}
.link-card:hover{
  transform:translateY(-2px);
  box-shadow:0 10px 22px rgba(0,0,0,.10);
}

.link-card .lc-ico{
  grid-area:ico;
  width:42px;height:42px;border-radius:50%;
  display:grid;place-items:center;flex:0 0 42px;
  background:radial-gradient(closest-side,#fff 64%,transparent 66%),
             conic-gradient(var(--ring-steel-from),var(--ring-steel-to));
  box-shadow:0 6px 14px rgba(0,0,0,.08), inset 0 0 0 1px rgba(255,255,255,.8);
}
body.dark .link-card .lc-ico{
  background:radial-gradient(closest-side,#0b1220 64%,transparent 66%),
             conic-gradient(var(--ring-steel-from),var(--ring-steel-to));
}

.link-card .lc-ico svg{ width:22px;height:22px;color:var(--brand) }

.link-card .lc-title{
  grid-area:title;
  font-weight:700;
  font-size:.98rem;
  color:var(--ink);
  line-height:1.2;
}
.link-card .lc-note{
  grid-area:note;
  font-size:.82rem;
  color:var(--ink-2);
  margin-top:.15rem;
}

.link-card .lc-open{
  grid-area:open;
  width:28px;height:28px;
  border:1px solid var(--border);
  border-radius:.5rem;
  display:grid;place-items:center;
  background:var(--res-open-bg);
  color:var(--res-title);
  transition: filter .15s ease, background .15s ease;
}
.link-card:hover .lc-open{ filter:brightness(.98) }
.link-card .lc-open svg{ width:16px;height:16px;stroke:currentColor }

/* make the whole card clickable but keep good focus outline */
.link-card:focus-visible{ outline:2px solid var(--brand); outline-offset:2px }

/* =========================
   Search Results (dropdown)
   ========================= */

/* Container */
.results{
  position:absolute; top:100%; left:0; right:0; margin-top:.35rem;
  background: var(--res-bg);
  border: 1px solid var(--border);
  border-radius: .6rem;
  box-shadow: 0 14px 34px rgba(0,0,0,.28);
  max-height:360px; overflow:auto;
  z-index:2000;
  display:none;
  overflow-anchor:none;
}
.results.visible{ display:block; }

/* Header */
.res-header{
  padding:.5rem .8rem;
  font-weight:600; font-size:.85rem;
  color: var(--res-sub);
  background: linear-gradient(180deg, rgba(0,0,0,.02), rgba(0,0,0,.04));
  border-bottom:1px solid var(--border);
}
body.dark .res-header{
  background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.06));
}

/* Row */
.res-item{
  display:flex; align-items:center; justify-content:space-between;
  gap:.6rem; padding:.6rem .8rem;
  color: var(--res-title);
  background: var(--res-row);
  border-top:1px solid var(--border);
  cursor:pointer;
  transition: background .15s ease, transform .08s ease;
}
.res-item:first-of-type{ border-top:0 }
.res-item:hover{ background: var(--res-row-hover); transform: translateX(1px); }

/* Left block */
.res-title-btn{
  flex:1; display:flex; align-items:flex-start; gap:.5rem;
  background:none; border:0; padding:0; text-align:left; color:inherit; cursor:pointer;
}
.res-ico{
  width:24px; height:24px; border-radius:.4rem; display:grid; place-items:center;
  background: linear-gradient(180deg,#f8fafc,#eef2f7);
}
body.dark .res-ico{ background: linear-gradient(180deg,#0b1220,#0f172a) }
.res-title-text{ font-weight:700; color: var(--res-title) }
.res-title-btn:hover .res-title-text{ text-decoration:underline }
.res-sub{ font-size:.82rem; color: var(--res-sub) }
.res-url{ color: var(--res-url); text-decoration:none; word-break:break-all }

/* Right button */
.res-open-btn{
  background: var(--res-open-bg);
  color: var(--res-title);
  border: 1px solid var(--border);
  padding:.28rem .4rem; border-radius:.45rem; line-height:0; cursor:pointer;
  transition: filter .15s ease, background .15s ease;
}
.res-open-btn svg{ stroke: currentColor; width:16px; height:16px; display:block; }

body.dark .res-open-btn{
  background:#0f172a;
  color:#e5e7eb;
}
.res-open-btn:hover{ filter:brightness(.98); }

/* Keyboard focus */
.res-title-btn:focus-visible,
.res-open-btn:focus-visible{
  outline:2px solid var(--brand);
  outline-offset:2px; border-radius:.35rem;
}

/* Keep dropdown readable above hero gradient */
.hero .results{
  background: var(--res-bg);
  border-color: var(--border);
  color: var(--res-title);
}
.hero .results .res-header{ color: var(--res-sub) }
.hero .results .res-item,
.hero .results .res-title-text{ color: var(--res-title) }
.hero .results .res-sub,
.hero .results .res-url{ color: var(--res-sub) }

/* High-contrast users */
@media (prefers-contrast: more){
  .res-item:hover{
    background: color-mix(in srgb, var(--res-row) 80%, #000 20%);
  }
  body.dark .res-item:hover{
    background: color-mix(in srgb, var(--res-row) 80%, #fff 20%);
  }
}

/* Neutralize blue button fill in results */
:root{
  --res-row: #ffffff;
  --res-title: #111827;
  --res-sub: #475569;
  --res-url: #374151;
}
body.dark{
  --res-row: #141c2b;
  --res-title: #ffffff;
  --res-sub: #cbd5e1;
  --res-url: #bac7d6;
}
.results { background: var(--res-bg, var(--card)); }
.res-item,
.res-item:hover,
.res-item:focus,
.res-item:focus-within { background: var(--res-row) !important; }
.res-title-btn { background: transparent !important; appearance: none; }
.res-title-btn:hover { background: transparent !important; }
.res-title-text { color: var(--res-title) !important; }
.res-sub       { color: var(--res-sub)   !important; }
.res-url       { color: var(--res-url)   !important; }
body:not(.dark) .res-item:hover { filter: brightness(0.98); }
body.dark .res-item:hover { background: #1b2436 !important; }

/* Passcode gate dark theming */
body.dark #lockScreen { background: var(--bg, #111827); }
body.dark #lockScreen div { background: var(--card, #1f2937); }
body.dark #passInput { background: #111827; color: #f9fafb; border-color: #374151; }

/* ========== Dark Mode Polish ========== */
:root { --t-fast: .15s; --t-med: .25s; }

body.dark {
  --bg:        #0f1520;
  --bg-2:      #111827;
  --card:      #131b29;
  --card-2:    #0f1623;
  --ink:       #e6edf3;
  --ink-2:     #9fb4c7;
  --ink-3:     #7b8fa6;
  --brand:     #5aa7ff;
  --brand-2:   #2f7de8;
  --ok:        #47d16c;
  --warn:      #ffc857;
  --err:       #ff6b6b;
  --border:    rgba(255,255,255,.08);
  --ring:      rgba(90,167,255,.45);
  --shadow:    0 10px 30px rgba(0,0,0,.45);
  color: var(--ink);
  background: radial-gradient(1200px 600px at 20% -10%, #173055 0%, transparent 60%),
              radial-gradient(1200px 600px at 100% -20%, #1b2440 0%, transparent 60%),
              var(--bg);
}

/* Header/hero with subtle glow */
body.dark .site-header {
  background: linear-gradient(180deg, rgba(19,31,53,.92), rgba(19,31,53,.75));
  border-bottom: 1px solid var(--border);
  backdrop-filter: saturate(120%) blur(6px);
}
body.dark .hero {
  background: linear-gradient(180deg, rgba(33,55,97,.45), rgba(33,55,97,0) 70%);
}

/* Buttons */
body.dark .icon-btn,
body.dark .search button,
body.dark .btn {
  background: linear-gradient(180deg, var(--brand) 0%, var(--brand-2) 100%);
  color: white;
  border: 0;
  border-radius: .65rem;
  box-shadow: 0 4px 14px rgba(90,167,255,.28);
  transition: transform var(--t-fast), box-shadow var(--t-fast), filter var(--t-fast);
}
body.dark .icon-btn:hover,
body.dark .search button:hover,
body.dark .btn:hover { filter: brightness(1.05); transform: translateY(-1px); }
body.dark .icon-btn:active,
body.dark .search button:active,
body.dark .btn:active  { transform: translateY(0); }

/* Inputs */
body.dark .search input,
body.dark input[type="search"],
body.dark input[type="text"],
body.dark select {
  background: linear-gradient(180deg, var(--card) 0%, var(--card-2) 100%);
  color: var(--ink);
  border: 1px solid var(--border);
  border-radius: .75rem;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.02);
}
body.dark .search input::placeholder,
body.dark input::placeholder { color: var(--ink-3); }

/* Focus ring */
body.dark .search input:focus,
body.dark .search button:focus,
body.dark a:focus,
body.dark button:focus,
body.dark select:focus {
  outline: none;
  box-shadow: 0 0 0 3px var(--ring);
}

/* Category tiles */
body.dark .categories .category {
  background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.00));
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shadow);
  transition: transform var(--t-med), box-shadow var(--t-med), border-color var(--t-fast);
}
body.dark .categories .category:hover {
  transform: translateY(-3px);
  border-color: rgba(90,167,255,.25);
  box-shadow: 0 12px 34px rgba(20,27,38,.6);
}
body.dark .categories .category .title { color: var(--ink); }
body.dark .categories .category svg { color: var(--brand); opacity: .95; }

/* Link cards */
body.dark .link-card {
  background: linear-gradient(180deg, var(--card) 0%, var(--card-2) 100%);
  border: 1px solid var(--border);
  border-radius: 16px;
  box-shadow: var(--shadow);
  transition: transform var(--t-med), border-color var(--t-fast), box-shadow var(--t-med);
}
body.dark .link-card:hover {
  transform: translateY(-2px);
  border-color: rgba(90,167,255,.25);
  box-shadow: 0 14px 36px rgba(9,12,18,.7);
}
body.dark .lc-title { color: var(--ink); }
body.dark .lc-note  { color: var(--ink-2); }
body.dark .lc-ico svg,
body.dark .lc-open svg { color: var(--brand); }

/* Optional: sticky section tools (uncomment if you want sticky search) */
/*
.links-tools {
  position: sticky;
  top: calc(var(--header-h) + 8px);
  z-index: 30;
}
@media (max-width: 900px){
  .links-tools { position: static; }
}
*/

/* Tables (contacts) */
body.dark .contacts-table {
  background: var(--card);
  color: var(--ink);
  border: 1px solid var(--border);
}
body.dark .contacts-table thead th {
  background: rgba(255,255,255,.03);
  color: var(--ink);
  border-bottom: 1px solid var(--border);
}
body.dark .contacts-table tbody tr:hover {
  background: rgba(90,167,255,.06);
}

/* Footer */
body.dark #footer {
  background: rgba(13,18,28,.85);
  color: var(--ink-2);
  border-top: 1px solid var(--border);
}

/* Scrollbar (WebKit) */
body.dark *::-webkit-scrollbar{ height:10px; width:10px; }
body.dark *::-webkit-scrollbar-track{ background: transparent; }
body.dark *::-webkit-scrollbar-thumb{
  background: rgba(255,255,255,.12);
  border-radius: 10px; border: 2px solid transparent; background-clip: padding-box;
}
body.dark *::-webkit-scrollbar-thumb:hover{ background: rgba(255,255,255,.18); }

/* Modals (Top Performers) */
body.dark .tp-overlay { background: rgba(5,8,13,.7); backdrop-filter: blur(2px); }
body.dark .tp-modal {
  background: linear-gradient(180deg, var(--card) 0%, var(--card-2) 100%);
  border: 1px solid var(--border); color: var(--ink); box-shadow: var(--shadow);
}
body.dark .tp-head { border-bottom: 1px solid var(--border); }

/* ---- Section header (Title + Search inline) ---- */
.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  gap: 1rem;
  flex-wrap: wrap;
}
.section-header h2 { margin: 0; font-size: 1.4rem; font-weight: 600; }

.links-tools {
  display: flex;
  align-items: center;
  gap: .5rem;
}
.links-tools input.links-filter {
  padding: .4rem .6rem;
  min-width: 220px;
  border: 1px solid var(--border);
  border-radius: .5rem;
  background: var(--card);
  color: var(--ink);
}
.links-tools .links-count {
  font-size: 0.85rem;
  color: var(--ink-2);
}
